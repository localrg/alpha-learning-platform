var wt=Object.defineProperty;var vt=i=>{throw TypeError(i)};var St=(i,e,t)=>e in i?wt(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var c=(i,e,t)=>St(i,typeof e!="symbol"?e+"":e,t),tt=(i,e,t)=>e.has(i)||vt("Cannot "+t);var o=(i,e,t)=>(tt(i,e,"read from private field"),t?t.call(i):e.get(i)),f=(i,e,t)=>e.has(i)?vt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),a=(i,e,t,n)=>(tt(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t),T=(i,e,t)=>(tt(i,e,"access private method"),t);const At=["abort","canplay","canplaythrough","durationchange","emptied","encrypted","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting","waitingforkey","resize","enterpictureinpicture","leavepictureinpicture","webkitbeginfullscreen","webkitendfullscreen","webkitpresentationmodechanged"],gt=["autopictureinpicture","disablepictureinpicture","disableremoteplayback","autoplay","controls","controlslist","crossorigin","loop","muted","playsinline","poster","preload","src"];function xt(i){return`
    <style>
      :host {
        display: inline-flex;
        line-height: 0;
        flex-direction: column;
        justify-content: end;
      }

      audio {
        width: 100%;
      }
    </style>
    <slot name="media">
      <audio${Et(i)}></audio>
    </slot>
    <slot></slot>
  `}function qt(i){return`
    <style>
      :host {
        display: inline-block;
        line-height: 0;
      }

      video {
        max-width: 100%;
        max-height: 100%;
        min-width: 100%;
        min-height: 100%;
        object-fit: var(--media-object-fit, contain);
        object-position: var(--media-object-position, 50% 50%);
      }

      video::-webkit-media-text-track-container {
        transform: var(--media-webkit-text-track-transform);
        transition: var(--media-webkit-text-track-transition);
      }
    </style>
    <slot name="media">
      <video${Et(i)}></video>
    </slot>
    <slot></slot>
  `}function Tt(i,{tag:e,is:t}){var k,g,v,y,Q,kt,W,G,E,J,l,V,et,mt,it,yt,bt;const n=(g=(k=globalThis.document)==null?void 0:k.createElement)==null?void 0:g.call(k,e,{is:t}),d=n?Ot(n):[];return v=class extends i{constructor(){super(...arguments);f(this,l);f(this,W,!1);f(this,G,null);f(this,E,new Map);f(this,J);c(this,"get");c(this,"set");c(this,"call")}static get observedAttributes(){var u,m;return T(u=v,Q,kt).call(u),[...((m=n==null?void 0:n.constructor)==null?void 0:m.observedAttributes)??[],...gt]}get nativeEl(){var s;return T(this,l,V).call(this),o(this,G)??this.querySelector(":scope > [slot=media]")??this.querySelector(e)??((s=this.shadowRoot)==null?void 0:s.querySelector(e))??null}set nativeEl(s){a(this,G,s)}get defaultMuted(){return this.hasAttribute("muted")}set defaultMuted(s){this.toggleAttribute("muted",s)}get src(){return this.getAttribute("src")}set src(s){this.setAttribute("src",`${s}`)}get preload(){var s;return this.getAttribute("preload")??((s=this.nativeEl)==null?void 0:s.preload)}set preload(s){this.setAttribute("preload",`${s}`)}init(){if(!this.shadowRoot){this.attachShadow({mode:"open"});const s=jt(this.attributes);t&&(s.is=t),e&&(s.part=e),this.shadowRoot.innerHTML=this.constructor.getTemplateHTML(s)}this.nativeEl.muted=this.hasAttribute("muted");for(const s of d)T(this,l,yt).call(this,s);a(this,J,new MutationObserver(T(this,l,mt).bind(this))),this.shadowRoot.addEventListener("slotchange",()=>T(this,l,et).call(this)),T(this,l,et).call(this);for(const s of this.constructor.Events)this.shadowRoot.addEventListener(s,this,!0)}handleEvent(s){s.target===this.nativeEl&&this.dispatchEvent(new CustomEvent(s.type,{detail:s.detail}))}attributeChangedCallback(s,u,m){T(this,l,V).call(this),T(this,l,bt).call(this,s,u,m)}connectedCallback(){T(this,l,V).call(this)}},y=new WeakMap,Q=new WeakSet,kt=function(){if(o(this,y))return;a(this,y,!0);const s=new Set(this.observedAttributes);s.delete("muted");for(const u of d)if(!(u in this.prototype))if(typeof n[u]=="function")this.prototype[u]=function(...m){return T(this,l,V).call(this),(()=>{var b;if(this.call)return this.call(u,...m);const h=(b=this.nativeEl)==null?void 0:b[u];return h==null?void 0:h.apply(this.nativeEl,m)})()};else{const m={get(){var h,b;T(this,l,V).call(this);const p=u.toLowerCase();if(s.has(p)){const H=this.getAttribute(p);return H===null?!1:H===""?!0:H}return((h=this.get)==null?void 0:h.call(this,u))??((b=this.nativeEl)==null?void 0:b[u])}};u!==u.toUpperCase()&&(m.set=function(p){T(this,l,V).call(this);const h=u.toLowerCase();if(s.has(h)){p===!0||p===!1||p==null?this.toggleAttribute(h,!!p):this.setAttribute(h,p);return}if(this.set){this.set(u,p);return}this.nativeEl&&(this.nativeEl[u]=p)}),Object.defineProperty(this.prototype,u,m)}},W=new WeakMap,G=new WeakMap,E=new WeakMap,J=new WeakMap,l=new WeakSet,V=function(){o(this,W)||(a(this,W,!0),this.init())},et=function(){var p;const s=new Map(o(this,E)),u=(p=this.shadowRoot)==null?void 0:p.querySelector("slot:not([name])");(u==null?void 0:u.assignedElements({flatten:!0}).filter(h=>["track","source"].includes(h.localName))).forEach(h=>{var H,ft;s.delete(h);let b=o(this,E).get(h);b||(b=h.cloneNode(),o(this,E).set(h,b),(H=o(this,J))==null||H.observe(h,{attributes:!0})),(ft=this.nativeEl)==null||ft.append(b),T(this,l,it).call(this,b)}),s.forEach((h,b)=>{h.remove(),o(this,E).delete(b)})},mt=function(s){for(const u of s)if(u.type==="attributes"){const{target:m,attributeName:p}=u,h=o(this,E).get(m);h&&p&&(h.setAttribute(p,m.getAttribute(p)??""),T(this,l,it).call(this,h))}},it=function(s){s&&s.localName==="track"&&s.default&&(s.kind==="chapters"||s.kind==="metadata")&&s.track.mode==="disabled"&&(s.track.mode="hidden")},yt=function(s){if(Object.prototype.hasOwnProperty.call(this,s)){const u=this[s];delete this[s],this[s]=u}},bt=function(s,u,m){var p,h,b;["id","class"].includes(s)||!v.observedAttributes.includes(s)&&this.constructor.observedAttributes.includes(s)||(m===null?(p=this.nativeEl)==null||p.removeAttribute(s):((h=this.nativeEl)==null?void 0:h.getAttribute(s))!==m&&((b=this.nativeEl)==null||b.setAttribute(s,m)))},f(v,Q),c(v,"getTemplateHTML",e.endsWith("audio")?xt:qt),c(v,"shadowRootOptions",{mode:"open"}),c(v,"Events",At),f(v,y,!1),v}function Ot(i){const e=[];for(let t=Object.getPrototypeOf(i);t&&t!==HTMLElement.prototype;t=Object.getPrototypeOf(t)){const n=Object.getOwnPropertyNames(t);e.push(...n)}return e}function Et(i){let e="";for(const t in i){if(!gt.includes(t))continue;const n=i[t];n===""?e+=` ${t}`:e+=` ${t}="${n}"`}return e}function jt(i){const e={};for(const t of i)e[t.name]=t.value;return e}const Jt=Tt(globalThis.HTMLElement??class{},{tag:"video"});Tt(globalThis.HTMLElement??class{},{tag:"audio"});class Z extends Event{constructor(t,n){super(t);c(this,"track");this.track=n.track}}const nt=new WeakMap;function r(i){return nt.get(i)??Pt(i,{})}function Pt(i,e){let t=nt.get(i);return t||nt.set(i,t={}),Object.assign(t,e)}function rt(i,e){const t=i.videoTracks;r(e).media=i,r(e).renditionSet||(r(e).renditionSet=new Set);const n=r(t).trackSet;n.add(e);const d=n.size-1;d in st.prototype||Object.defineProperty(st.prototype,d,{get(){return[...r(this).trackSet][d]}}),queueMicrotask(()=>{t.dispatchEvent(new Z("addtrack",{track:e}))})}function ot(i){var n;const e=(n=r(i).media)==null?void 0:n.videoTracks;if(!e)return;r(e).trackSet.delete(i),queueMicrotask(()=>{e.dispatchEvent(new Z("removetrack",{track:i}))})}function $t(i){const e=r(i).media.videoTracks??[];let t=!1;for(const n of e)n!==i&&(n.selected=!1,t=!0);if(t){if(r(e).changeRequested)return;r(e).changeRequested=!0,queueMicrotask(()=>{delete r(e).changeRequested,e.dispatchEvent(new Event("change"))})}}var L,R,w,I,K;class st extends EventTarget{constructor(){super();f(this,I);f(this,L);f(this,R);f(this,w);r(this).trackSet=new Set}[Symbol.iterator](){return o(this,I,K).values()}get length(){return o(this,I,K).size}getTrackById(t){return[...o(this,I,K)].find(n=>n.id===t)??null}get selectedIndex(){return[...o(this,I,K)].findIndex(t=>t.selected)}get onaddtrack(){return o(this,L)}set onaddtrack(t){o(this,L)&&(this.removeEventListener("addtrack",o(this,L)),a(this,L,void 0)),typeof t=="function"&&(a(this,L,t),this.addEventListener("addtrack",t))}get onremovetrack(){return o(this,R)}set onremovetrack(t){o(this,R)&&(this.removeEventListener("removetrack",o(this,R)),a(this,R,void 0)),typeof t=="function"&&(a(this,R,t),this.addEventListener("removetrack",t))}get onchange(){return o(this,w)}set onchange(t){o(this,w)&&(this.removeEventListener("change",o(this,w)),a(this,w,void 0)),typeof t=="function"&&(a(this,w,t),this.addEventListener("change",t))}}L=new WeakMap,R=new WeakMap,w=new WeakMap,I=new WeakSet,K=function(){return r(this).trackSet};class _ extends Event{constructor(t,n){super(t);c(this,"rendition");this.rendition=n.rendition}}function Mt(i,e){const t=r(i).media.videoRenditions;r(e).media=r(i).media,r(e).track=i;const n=r(i).renditionSet;n.add(e);const d=n.size-1;d in dt.prototype||Object.defineProperty(dt.prototype,d,{get(){return z(this)[d]}}),queueMicrotask(()=>{i.selected&&t.dispatchEvent(new _("addrendition",{rendition:e}))})}function Vt(i){const e=r(i).media.videoRenditions,t=r(i).track;r(t).renditionSet.delete(i),queueMicrotask(()=>{r(i).track.selected&&e.dispatchEvent(new _("removerendition",{rendition:i}))})}function It(i){const e=r(i).media.videoRenditions;!e||r(e).changeRequested||(r(e).changeRequested=!0,queueMicrotask(()=>{delete r(e).changeRequested,r(i).track.selected&&e.dispatchEvent(new Event("change"))}))}function z(i){return[...r(i).media.videoTracks].filter(t=>t.selected).flatMap(t=>[...r(t).renditionSet])}var S,A,x;class dt extends EventTarget{constructor(){super(...arguments);f(this,S);f(this,A);f(this,x)}[Symbol.iterator](){return z(this).values()}get length(){return z(this).length}getRenditionById(t){return z(this).find(n=>`${n.id}`==`${t}`)??null}get selectedIndex(){return z(this).findIndex(t=>t.selected)}set selectedIndex(t){for(const[n,d]of z(this).entries())d.selected=n===t}get onaddrendition(){return o(this,S)}set onaddrendition(t){o(this,S)&&(this.removeEventListener("addrendition",o(this,S)),a(this,S,void 0)),typeof t=="function"&&(a(this,S,t),this.addEventListener("addrendition",t))}get onremoverendition(){return o(this,A)}set onremoverendition(t){o(this,A)&&(this.removeEventListener("removerendition",o(this,A)),a(this,A,void 0)),typeof t=="function"&&(a(this,A,t),this.addEventListener("removerendition",t))}get onchange(){return o(this,x)}set onchange(t){o(this,x)&&(this.removeEventListener("change",o(this,x)),a(this,x,void 0)),typeof t=="function"&&(a(this,x,t),this.addEventListener("change",t))}}S=new WeakMap,A=new WeakMap,x=new WeakMap;var C;class Ht{constructor(){c(this,"src");c(this,"id");c(this,"width");c(this,"height");c(this,"bitrate");c(this,"frameRate");c(this,"codec");f(this,C,!1)}get selected(){return o(this,C)}set selected(e){o(this,C)!==e&&(a(this,C,e),It(this))}}C=new WeakMap;var F;class Lt{constructor(){c(this,"id");c(this,"kind");c(this,"label","");c(this,"language","");c(this,"sourceBuffer");f(this,F,!1)}addRendition(e,t,n,d,k,g){const v=new Ht;return v.src=e,v.width=t,v.height=n,v.frameRate=g,v.bitrate=k,v.codec=d,Mt(this,v),v}removeRendition(e){Vt(e)}get selected(){return o(this,F)}set selected(e){o(this,F)!==e&&(a(this,F,e),e===!0&&$t(this))}}F=new WeakMap;function zt(i,e){const t=r(i).media.audioRenditions;r(e).media=r(i).media,r(e).track=i;const n=r(i).renditionSet;n.add(e);const d=n.size-1;d in at.prototype||Object.defineProperty(at.prototype,d,{get(){return B(this)[d]}}),queueMicrotask(()=>{i.enabled&&t.dispatchEvent(new _("addrendition",{rendition:e}))})}function Bt(i){const e=r(i).media.audioRenditions,t=r(i).track;r(t).renditionSet.delete(i),queueMicrotask(()=>{r(i).track.enabled&&e.dispatchEvent(new _("removerendition",{rendition:i}))})}function Ct(i){const e=r(i).media.audioRenditions;!e||r(e).changeRequested||(r(e).changeRequested=!0,queueMicrotask(()=>{delete r(e).changeRequested,r(i).track.enabled&&e.dispatchEvent(new Event("change"))}))}function B(i){return[...r(i).media.audioTracks].filter(t=>t.enabled).flatMap(t=>[...r(t).renditionSet])}var q,O,j;class at extends EventTarget{constructor(){super(...arguments);f(this,q);f(this,O);f(this,j)}[Symbol.iterator](){return B(this).values()}get length(){return B(this).length}getRenditionById(t){return B(this).find(n=>`${n.id}`==`${t}`)??null}get selectedIndex(){return B(this).findIndex(t=>t.selected)}set selectedIndex(t){for(const[n,d]of B(this).entries())d.selected=n===t}get onaddrendition(){return o(this,q)}set onaddrendition(t){o(this,q)&&(this.removeEventListener("addrendition",o(this,q)),a(this,q,void 0)),typeof t=="function"&&(a(this,q,t),this.addEventListener("addrendition",t))}get onremoverendition(){return o(this,O)}set onremoverendition(t){o(this,O)&&(this.removeEventListener("removerendition",o(this,O)),a(this,O,void 0)),typeof t=="function"&&(a(this,O,t),this.addEventListener("removerendition",t))}get onchange(){return o(this,j)}set onchange(t){o(this,j)&&(this.removeEventListener("change",o(this,j)),a(this,j,void 0)),typeof t=="function"&&(a(this,j,t),this.addEventListener("change",t))}}q=new WeakMap,O=new WeakMap,j=new WeakMap;var D;class Ft{constructor(){c(this,"src");c(this,"id");c(this,"bitrate");c(this,"codec");f(this,D,!1)}get selected(){return o(this,D)}set selected(e){o(this,D)!==e&&(a(this,D,e),Ct(this))}}D=new WeakMap;function ct(i,e){const t=i.audioTracks;r(e).media=i,r(e).renditionSet||(r(e).renditionSet=new Set);const n=r(t).trackSet;n.add(e);const d=n.size-1;d in ht.prototype||Object.defineProperty(ht.prototype,d,{get(){return[...r(this).trackSet][d]}}),queueMicrotask(()=>{t.dispatchEvent(new Z("addtrack",{track:e}))})}function ut(i){var n;const e=(n=r(i).media)==null?void 0:n.audioTracks;if(!e)return;r(e).trackSet.delete(i),queueMicrotask(()=>{e.dispatchEvent(new Z("removetrack",{track:i}))})}function Dt(i){const e=r(i).media.audioTracks;!e||r(e).changeRequested||(r(e).changeRequested=!0,queueMicrotask(()=>{delete r(e).changeRequested,e.dispatchEvent(new Event("change"))}))}var P,$,M,N,X;class ht extends EventTarget{constructor(){super();f(this,N);f(this,P);f(this,$);f(this,M);r(this).trackSet=new Set}[Symbol.iterator](){return o(this,N,X).values()}get length(){return o(this,N,X).size}getTrackById(t){return[...o(this,N,X)].find(n=>n.id===t)??null}get onaddtrack(){return o(this,P)}set onaddtrack(t){o(this,P)&&(this.removeEventListener("addtrack",o(this,P)),a(this,P,void 0)),typeof t=="function"&&(a(this,P,t),this.addEventListener("addtrack",t))}get onremovetrack(){return o(this,$)}set onremovetrack(t){o(this,$)&&(this.removeEventListener("removetrack",o(this,$)),a(this,$,void 0)),typeof t=="function"&&(a(this,$,t),this.addEventListener("removetrack",t))}get onchange(){return o(this,M)}set onchange(t){o(this,M)&&(this.removeEventListener("change",o(this,M)),a(this,M,void 0)),typeof t=="function"&&(a(this,M,t),this.addEventListener("change",t))}}P=new WeakMap,$=new WeakMap,M=new WeakMap,N=new WeakSet,X=function(){return r(this).trackSet};var U;class Rt{constructor(){c(this,"id");c(this,"kind");c(this,"label","");c(this,"language","");c(this,"sourceBuffer");f(this,U,!1)}addRendition(e,t,n){const d=new Ft;return d.src=e,d.codec=t,d.bitrate=n,zt(this,d),d}removeRendition(e){Bt(e)}get enabled(){return o(this,U)}set enabled(e){o(this,U)!==e&&(a(this,U,e),Dt(this))}}U=new WeakMap;const lt=Y(globalThis.HTMLMediaElement,"video"),pt=Y(globalThis.HTMLMediaElement,"audio");function Kt(i){if(!(i!=null&&i.prototype))return i;const e=Y(i,"video");(!e||`${e}`.includes("[native code]"))&&Object.defineProperty(i.prototype,"videoTracks",{get(){return Nt(this)}});const t=Y(i,"audio");(!t||`${t}`.includes("[native code]"))&&Object.defineProperty(i.prototype,"audioTracks",{get(){return Ut(this)}}),"addVideoTrack"in i.prototype||(i.prototype.addVideoTrack=function(k,g="",v=""){const y=new Lt;return y.kind=k,y.label=g,y.language=v,rt(this,y),y}),"removeVideoTrack"in i.prototype||(i.prototype.removeVideoTrack=ot),"addAudioTrack"in i.prototype||(i.prototype.addAudioTrack=function(k,g="",v=""){const y=new Rt;return y.kind=k,y.label=g,y.language=v,ct(this,y),y}),"removeAudioTrack"in i.prototype||(i.prototype.removeAudioTrack=ut),"videoRenditions"in i.prototype||Object.defineProperty(i.prototype,"videoRenditions",{get(){return n(this)}});const n=k=>{let g=r(k).videoRenditions;return g||(g=new dt,r(g).media=k,r(k).videoRenditions=g),g};"audioRenditions"in i.prototype||Object.defineProperty(i.prototype,"audioRenditions",{get(){return d(this)}});const d=k=>{let g=r(k).audioRenditions;return g||(g=new at,r(g).media=k,r(k).audioRenditions=g),g};return i}function Y(i,e){var t;if(i!=null&&i.prototype)return(t=Object.getOwnPropertyDescriptor(i.prototype,`${e}Tracks`))==null?void 0:t.get}function Nt(i){let e=r(i).videoTracks;if(!e&&(e=new st,r(i).videoTracks=e,lt)){const t=lt.call(i.nativeEl??i);for(const n of t)rt(i,n);t.addEventListener("change",()=>{e.dispatchEvent(new Event("change"))}),t.addEventListener("addtrack",n=>{if([...e].some(d=>d instanceof Lt)){for(const d of t)ot(d);return}rt(i,n.track)}),t.addEventListener("removetrack",n=>{ot(n.track)})}return e}function Ut(i){let e=r(i).audioTracks;if(!e&&(e=new ht,r(i).audioTracks=e,pt)){const t=pt.call(i.nativeEl??i);for(const n of t)ct(i,n);t.addEventListener("change",()=>{e.dispatchEvent(new Event("change"))}),t.addEventListener("addtrack",n=>{if([...e].some(d=>d instanceof Rt)){for(const d of t)ut(d);return}ct(i,n.track)}),t.addEventListener("removetrack",n=>{ut(n.track)})}return e}export{Jt as C,Kt as M};
